package com.healthcare.service;

import org.springframework.stereotype.Service;
import org.springframework.web.client.RestClientException;
import org.springframework.web.client.RestTemplate;

import com.healthcare.dto.ApiResponse;
import com.healthcare.dto.VideoResponseDto;
import com.healthcare.exception_handler.ResourceNotFoundException;

import lombok.NoArgsConstructor;

@Service
@NoArgsConstructor
public class YoutubeApiServiceImpl implements YoutubeApiService{

	public String verifyURL(String vID){
		RestTemplate restTemplate = new RestTemplate();
		String api = "https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v="+vID+"&format=json";
		try {
			restTemplate.getForObject(api, String.class);
			String iframe = String.format(
				    "<iframe width='640' height='320' " +
				    	    "src='https://www.youtube.com/embed/%s' " +
				    	    "frameborder='0' " +
				    	    "allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope' " +
				    	    "allowfullscreen></iframe>",
				    	    vID
				    	);

//			VideoResponseDto vDto = new VideoResponseDto();
//			vDto.setVideoId(iframe);
			return iframe
//			return new ApiResponse<VideoResponseDto>(vDto,true,"Success");
		}
		catch (RestClientException e) {
			throw new ResourceNotFoundException("Invalid video id OR no network access ");
		}
	}
	
}
